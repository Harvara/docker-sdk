server {
    server_name _ default; # This is just an invalid value which will never trigger on a real hostname.
    listen 80;
    access_log off;
    return 200;
}

{% for groupData in groups %}
{% for applicationName, applicationData in groupData['applications'] %}
{% for endpoint, endpointData in applicationData['endpoints'] %}
{% set applicationType = applicationData['application'] == 'zed' ? 'rpc' : applicationData['application'] %}
{% include "nginx/http/#{applicationType}.server.conf.twig" with {
    ssl: false,
    endpoint: endpoint,
    endpointData: endpointData,
    storeServices: regions[groupData['region']]['stores'][endpointData['store']]['services'] | default([]),
    upstream: "${SPRYKER_NGINX_CGI_HOST_" ~ (applicationName | upper) ~ "}" ~ ":9000",
    rpcServer: null,
    zedHost: _endpointMap[endpointData['store']]['zed'] | default(''),
    project: _context
} %}
{% endfor %}
{% endfor %}
{% endfor %}
